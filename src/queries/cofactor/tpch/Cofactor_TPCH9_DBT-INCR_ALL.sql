CREATE STREAM LINEITEM (
        orderkey       INT,
        partkey        INT,
        suppkey        INT,
        linenumber     INT,
        quantity       DECIMAL,
        extendedprice  DECIMAL,
        discount       DECIMAL,
        tax            DECIMAL,
        returnflag     DECIMAL,
        linestatus     DECIMAL,
        shipdate       INT,
        commitdate     INT,
        receiptdate    INT,
        shipinstruct   INT,
        shipmode       INT,
        comment        INT
    )
  FROM FILE './datasets/tpch/lineitem.csv'
  LINE DELIMITED CSV (delimiter := '|');


CREATE STREAM ORDERS (
        orderkey       INT,
        custkey        INT,
        orderstatus    INT,
        totalprice     DECIMAL,
        orderdate      DATE,
        orderpriority  INT,
        clerk          INT,
        shippriority   INT,
        comment        INT
    )
  FROM FILE './datasets/tpch/orders.csv'
  LINE DELIMITED CSV (delimiter := '|');

CREATE STREAM PART (
        partkey      INT,
        name         VARCHAR(55),
        mfgr         INT,
        brand        INT,
        type         INT,
        size         INT,
        container    INT,
        retailprice  DECIMAL,
        comment      INT
    )
  FROM FILE './datasets/tpch/part.csv'
  LINE DELIMITED CSV (delimiter := '|');


CREATE STREAM CUSTOMER (
        custkey      INT,
        name         INT,
        address      INT,
        nationkey    INT,
        phone        INT,
        acctbal      DECIMAL,
        mktsegment   INT,
        comment      INT
    )
  FROM FILE './datasets/tpch/customer.csv'
  LINE DELIMITED CSV (delimiter := '|');

CREATE STREAM SUPPLIER (
        suppkey      INT,
        name         INT,
        address      INT,
        nationkey    INT,
        phone        INT,
        acctbal      DECIMAL,
        comment      INT
    )
  FROM FILE './datasets/tpch/supplier.csv'
  LINE DELIMITED CSV (delimiter := '|');

CREATE STREAM PARTSUPP (
        partkey      INT,
        suppkey      INT,
        availqty     INT,
        supplycost   DECIMAL,
        comment      INT
    )
  FROM FILE './datasets/tpch/partsupp.csv'
  LINE DELIMITED CSV (delimiter := '|');

CREATE TABLE NATION (
        nationkey    INT,
        name         CHAR(25),
        regionkey    INT,
        comment      DECIMAL
    )
  FROM FILE './datasets/tpch/nation.csv'
  LINE DELIMITED CSV (delimiter := '|');

CREATE TABLE REGION (
        regionkey    INT,
        name         CHAR(25),
        comment      VARCHAR(152)
    )
  FROM FILE './datasets/tpch/region.csv'
  LINE DELIMITED CSV (delimiter := '|');


SELECT n.name AS nation, 
       EXTRACT(year from o.orderdate) AS o_year,
       SUM(l.orderkey*l.orderkey), SUM(l.orderkey*l.partkey), SUM(l.orderkey*l.suppkey), SUM(l.orderkey*l.linenumber), SUM(l.orderkey*l.quantity), SUM(l.orderkey*l.extendedprice), SUM(l.orderkey*l.discount), SUM(l.orderkey*l.tax), SUM(l.orderkey*l.returnflag), SUM(l.orderkey*l.linestatus), SUM(l.orderkey*l.shipdate), SUM(l.orderkey*l.commitdate), SUM(l.orderkey*l.receiptdate), SUM(l.orderkey*l.shipinstruct), SUM(l.orderkey*l.shipmode), SUM(l.orderkey*l.comment), SUM(l.orderkey*o.custkey), SUM(l.orderkey*o.orderstatus), SUM(l.orderkey*o.totalprice), SUM(l.orderkey*o.orderpriority), SUM(l.orderkey*o.clerk), SUM(l.orderkey*o.shippriority), SUM(l.orderkey*o.comment), SUM(l.orderkey*p.mfgr), SUM(l.orderkey*p.brand), SUM(l.orderkey*p.type), SUM(l.orderkey*p.size), SUM(l.orderkey*p.container), SUM(l.orderkey*p.retailprice), SUM(l.orderkey*p.comment), SUM(l.orderkey*s.name), SUM(l.orderkey*s.address), SUM(l.orderkey*s.nationkey), SUM(l.orderkey*s.phone), SUM(l.orderkey*s.acctbal), SUM(l.orderkey*s.comment), SUM(l.orderkey*ps.availqty), SUM(l.orderkey*ps.supplycost), SUM(l.orderkey*ps.comment), SUM(l.orderkey*n.regionkey), SUM(l.orderkey*n.comment), SUM(l.partkey*l.partkey), SUM(l.partkey*l.suppkey), SUM(l.partkey*l.linenumber), SUM(l.partkey*l.quantity), SUM(l.partkey*l.extendedprice), SUM(l.partkey*l.discount), SUM(l.partkey*l.tax), SUM(l.partkey*l.returnflag), SUM(l.partkey*l.linestatus), SUM(l.partkey*l.shipdate), SUM(l.partkey*l.commitdate), SUM(l.partkey*l.receiptdate), SUM(l.partkey*l.shipinstruct), SUM(l.partkey*l.shipmode), SUM(l.partkey*l.comment), SUM(l.partkey*o.custkey), SUM(l.partkey*o.orderstatus), SUM(l.partkey*o.totalprice), SUM(l.partkey*o.orderpriority), SUM(l.partkey*o.clerk), SUM(l.partkey*o.shippriority), SUM(l.partkey*o.comment), SUM(l.partkey*p.mfgr), SUM(l.partkey*p.brand), SUM(l.partkey*p.type), SUM(l.partkey*p.size), SUM(l.partkey*p.container), SUM(l.partkey*p.retailprice), SUM(l.partkey*p.comment), SUM(l.partkey*s.name), SUM(l.partkey*s.address), SUM(l.partkey*s.nationkey), SUM(l.partkey*s.phone), SUM(l.partkey*s.acctbal), SUM(l.partkey*s.comment), SUM(l.partkey*ps.availqty), SUM(l.partkey*ps.supplycost), SUM(l.partkey*ps.comment), SUM(l.partkey*n.regionkey), SUM(l.partkey*n.comment), SUM(l.suppkey*l.suppkey), SUM(l.suppkey*l.linenumber), SUM(l.suppkey*l.quantity), SUM(l.suppkey*l.extendedprice), SUM(l.suppkey*l.discount), SUM(l.suppkey*l.tax), SUM(l.suppkey*l.returnflag), SUM(l.suppkey*l.linestatus), SUM(l.suppkey*l.shipdate), SUM(l.suppkey*l.commitdate), SUM(l.suppkey*l.receiptdate), SUM(l.suppkey*l.shipinstruct), SUM(l.suppkey*l.shipmode), SUM(l.suppkey*l.comment), SUM(l.suppkey*o.custkey), SUM(l.suppkey*o.orderstatus), SUM(l.suppkey*o.totalprice), SUM(l.suppkey*o.orderpriority), SUM(l.suppkey*o.clerk), SUM(l.suppkey*o.shippriority), SUM(l.suppkey*o.comment), SUM(l.suppkey*p.mfgr), SUM(l.suppkey*p.brand), SUM(l.suppkey*p.type), SUM(l.suppkey*p.size), SUM(l.suppkey*p.container), SUM(l.suppkey*p.retailprice), SUM(l.suppkey*p.comment), SUM(l.suppkey*s.name), SUM(l.suppkey*s.address), SUM(l.suppkey*s.nationkey), SUM(l.suppkey*s.phone), SUM(l.suppkey*s.acctbal), SUM(l.suppkey*s.comment), SUM(l.suppkey*ps.availqty), SUM(l.suppkey*ps.supplycost), SUM(l.suppkey*ps.comment), SUM(l.suppkey*n.regionkey), SUM(l.suppkey*n.comment), SUM(l.linenumber*l.linenumber), SUM(l.linenumber*l.quantity), SUM(l.linenumber*l.extendedprice), SUM(l.linenumber*l.discount), SUM(l.linenumber*l.tax), SUM(l.linenumber*l.returnflag), SUM(l.linenumber*l.linestatus), SUM(l.linenumber*l.shipdate), SUM(l.linenumber*l.commitdate), SUM(l.linenumber*l.receiptdate), SUM(l.linenumber*l.shipinstruct), SUM(l.linenumber*l.shipmode), SUM(l.linenumber*l.comment), SUM(l.linenumber*o.custkey), SUM(l.linenumber*o.orderstatus), SUM(l.linenumber*o.totalprice), SUM(l.linenumber*o.orderpriority), SUM(l.linenumber*o.clerk), SUM(l.linenumber*o.shippriority), SUM(l.linenumber*o.comment), SUM(l.linenumber*p.mfgr), SUM(l.linenumber*p.brand), SUM(l.linenumber*p.type), SUM(l.linenumber*p.size), SUM(l.linenumber*p.container), SUM(l.linenumber*p.retailprice), SUM(l.linenumber*p.comment), SUM(l.linenumber*s.name), SUM(l.linenumber*s.address), SUM(l.linenumber*s.nationkey), SUM(l.linenumber*s.phone), SUM(l.linenumber*s.acctbal), SUM(l.linenumber*s.comment), SUM(l.linenumber*ps.availqty), SUM(l.linenumber*ps.supplycost), SUM(l.linenumber*ps.comment), SUM(l.linenumber*n.regionkey), SUM(l.linenumber*n.comment), SUM(l.quantity*l.quantity), SUM(l.quantity*l.extendedprice), SUM(l.quantity*l.discount), SUM(l.quantity*l.tax), SUM(l.quantity*l.returnflag), SUM(l.quantity*l.linestatus), SUM(l.quantity*l.shipdate), SUM(l.quantity*l.commitdate), SUM(l.quantity*l.receiptdate), SUM(l.quantity*l.shipinstruct), SUM(l.quantity*l.shipmode), SUM(l.quantity*l.comment), SUM(l.quantity*o.custkey), SUM(l.quantity*o.orderstatus), SUM(l.quantity*o.totalprice), SUM(l.quantity*o.orderpriority), SUM(l.quantity*o.clerk), SUM(l.quantity*o.shippriority), SUM(l.quantity*o.comment), SUM(l.quantity*p.mfgr), SUM(l.quantity*p.brand), SUM(l.quantity*p.type), SUM(l.quantity*p.size), SUM(l.quantity*p.container), SUM(l.quantity*p.retailprice), SUM(l.quantity*p.comment), SUM(l.quantity*s.name), SUM(l.quantity*s.address), SUM(l.quantity*s.nationkey), SUM(l.quantity*s.phone), SUM(l.quantity*s.acctbal), SUM(l.quantity*s.comment), SUM(l.quantity*ps.availqty), SUM(l.quantity*ps.supplycost), SUM(l.quantity*ps.comment), SUM(l.quantity*n.regionkey), SUM(l.quantity*n.comment), SUM(l.extendedprice*l.extendedprice), SUM(l.extendedprice*l.discount), SUM(l.extendedprice*l.tax), SUM(l.extendedprice*l.returnflag), SUM(l.extendedprice*l.linestatus), SUM(l.extendedprice*l.shipdate), SUM(l.extendedprice*l.commitdate), SUM(l.extendedprice*l.receiptdate), SUM(l.extendedprice*l.shipinstruct), SUM(l.extendedprice*l.shipmode), SUM(l.extendedprice*l.comment), SUM(l.extendedprice*o.custkey), SUM(l.extendedprice*o.orderstatus), SUM(l.extendedprice*o.totalprice), SUM(l.extendedprice*o.orderpriority), SUM(l.extendedprice*o.clerk), SUM(l.extendedprice*o.shippriority), SUM(l.extendedprice*o.comment), SUM(l.extendedprice*p.mfgr), SUM(l.extendedprice*p.brand), SUM(l.extendedprice*p.type), SUM(l.extendedprice*p.size), SUM(l.extendedprice*p.container), SUM(l.extendedprice*p.retailprice), SUM(l.extendedprice*p.comment), SUM(l.extendedprice*s.name), SUM(l.extendedprice*s.address), SUM(l.extendedprice*s.nationkey), SUM(l.extendedprice*s.phone), SUM(l.extendedprice*s.acctbal), SUM(l.extendedprice*s.comment), SUM(l.extendedprice*ps.availqty), SUM(l.extendedprice*ps.supplycost), SUM(l.extendedprice*ps.comment), SUM(l.extendedprice*n.regionkey), SUM(l.extendedprice*n.comment), SUM(l.discount*l.discount), SUM(l.discount*l.tax), SUM(l.discount*l.returnflag), SUM(l.discount*l.linestatus), SUM(l.discount*l.shipdate), SUM(l.discount*l.commitdate), SUM(l.discount*l.receiptdate), SUM(l.discount*l.shipinstruct), SUM(l.discount*l.shipmode), SUM(l.discount*l.comment), SUM(l.discount*o.custkey), SUM(l.discount*o.orderstatus), SUM(l.discount*o.totalprice), SUM(l.discount*o.orderpriority), SUM(l.discount*o.clerk), SUM(l.discount*o.shippriority), SUM(l.discount*o.comment), SUM(l.discount*p.mfgr), SUM(l.discount*p.brand), SUM(l.discount*p.type), SUM(l.discount*p.size), SUM(l.discount*p.container), SUM(l.discount*p.retailprice), SUM(l.discount*p.comment), SUM(l.discount*s.name), SUM(l.discount*s.address), SUM(l.discount*s.nationkey), SUM(l.discount*s.phone), SUM(l.discount*s.acctbal), SUM(l.discount*s.comment), SUM(l.discount*ps.availqty), SUM(l.discount*ps.supplycost), SUM(l.discount*ps.comment), SUM(l.discount*n.regionkey), SUM(l.discount*n.comment), SUM(l.tax*l.tax), SUM(l.tax*l.returnflag), SUM(l.tax*l.linestatus), SUM(l.tax*l.shipdate), SUM(l.tax*l.commitdate), SUM(l.tax*l.receiptdate), SUM(l.tax*l.shipinstruct), SUM(l.tax*l.shipmode), SUM(l.tax*l.comment), SUM(l.tax*o.custkey), SUM(l.tax*o.orderstatus), SUM(l.tax*o.totalprice), SUM(l.tax*o.orderpriority), SUM(l.tax*o.clerk), SUM(l.tax*o.shippriority), SUM(l.tax*o.comment), SUM(l.tax*p.mfgr), SUM(l.tax*p.brand), SUM(l.tax*p.type), SUM(l.tax*p.size), SUM(l.tax*p.container), SUM(l.tax*p.retailprice), SUM(l.tax*p.comment), SUM(l.tax*s.name), SUM(l.tax*s.address), SUM(l.tax*s.nationkey), SUM(l.tax*s.phone), SUM(l.tax*s.acctbal), SUM(l.tax*s.comment), SUM(l.tax*ps.availqty), SUM(l.tax*ps.supplycost), SUM(l.tax*ps.comment), SUM(l.tax*n.regionkey), SUM(l.tax*n.comment), SUM(l.returnflag*l.returnflag), SUM(l.returnflag*l.linestatus), SUM(l.returnflag*l.shipdate), SUM(l.returnflag*l.commitdate), SUM(l.returnflag*l.receiptdate), SUM(l.returnflag*l.shipinstruct), SUM(l.returnflag*l.shipmode), SUM(l.returnflag*l.comment), SUM(l.returnflag*o.custkey), SUM(l.returnflag*o.orderstatus), SUM(l.returnflag*o.totalprice), SUM(l.returnflag*o.orderpriority), SUM(l.returnflag*o.clerk), SUM(l.returnflag*o.shippriority), SUM(l.returnflag*o.comment), SUM(l.returnflag*p.mfgr), SUM(l.returnflag*p.brand), SUM(l.returnflag*p.type), SUM(l.returnflag*p.size), SUM(l.returnflag*p.container), SUM(l.returnflag*p.retailprice), SUM(l.returnflag*p.comment), SUM(l.returnflag*s.name), SUM(l.returnflag*s.address), SUM(l.returnflag*s.nationkey), SUM(l.returnflag*s.phone), SUM(l.returnflag*s.acctbal), SUM(l.returnflag*s.comment), SUM(l.returnflag*ps.availqty), SUM(l.returnflag*ps.supplycost), SUM(l.returnflag*ps.comment), SUM(l.returnflag*n.regionkey), SUM(l.returnflag*n.comment), SUM(l.linestatus*l.linestatus), SUM(l.linestatus*l.shipdate), SUM(l.linestatus*l.commitdate), SUM(l.linestatus*l.receiptdate), SUM(l.linestatus*l.shipinstruct), SUM(l.linestatus*l.shipmode), SUM(l.linestatus*l.comment), SUM(l.linestatus*o.custkey), SUM(l.linestatus*o.orderstatus), SUM(l.linestatus*o.totalprice), SUM(l.linestatus*o.orderpriority), SUM(l.linestatus*o.clerk), SUM(l.linestatus*o.shippriority), SUM(l.linestatus*o.comment), SUM(l.linestatus*p.mfgr), SUM(l.linestatus*p.brand), SUM(l.linestatus*p.type), SUM(l.linestatus*p.size), SUM(l.linestatus*p.container), SUM(l.linestatus*p.retailprice), SUM(l.linestatus*p.comment), SUM(l.linestatus*s.name), SUM(l.linestatus*s.address), SUM(l.linestatus*s.nationkey), SUM(l.linestatus*s.phone), SUM(l.linestatus*s.acctbal), SUM(l.linestatus*s.comment), SUM(l.linestatus*ps.availqty), SUM(l.linestatus*ps.supplycost), SUM(l.linestatus*ps.comment), SUM(l.linestatus*n.regionkey), SUM(l.linestatus*n.comment), SUM(l.shipdate*l.shipdate), SUM(l.shipdate*l.commitdate), SUM(l.shipdate*l.receiptdate), SUM(l.shipdate*l.shipinstruct), SUM(l.shipdate*l.shipmode), SUM(l.shipdate*l.comment), SUM(l.shipdate*o.custkey), SUM(l.shipdate*o.orderstatus), SUM(l.shipdate*o.totalprice), SUM(l.shipdate*o.orderpriority), SUM(l.shipdate*o.clerk), SUM(l.shipdate*o.shippriority), SUM(l.shipdate*o.comment), SUM(l.shipdate*p.mfgr), SUM(l.shipdate*p.brand), SUM(l.shipdate*p.type), SUM(l.shipdate*p.size), SUM(l.shipdate*p.container), SUM(l.shipdate*p.retailprice), SUM(l.shipdate*p.comment), SUM(l.shipdate*s.name), SUM(l.shipdate*s.address), SUM(l.shipdate*s.nationkey), SUM(l.shipdate*s.phone), SUM(l.shipdate*s.acctbal), SUM(l.shipdate*s.comment), SUM(l.shipdate*ps.availqty), SUM(l.shipdate*ps.supplycost), SUM(l.shipdate*ps.comment), SUM(l.shipdate*n.regionkey), SUM(l.shipdate*n.comment), SUM(l.commitdate*l.commitdate), SUM(l.commitdate*l.receiptdate), SUM(l.commitdate*l.shipinstruct), SUM(l.commitdate*l.shipmode), SUM(l.commitdate*l.comment), SUM(l.commitdate*o.custkey), SUM(l.commitdate*o.orderstatus), SUM(l.commitdate*o.totalprice), SUM(l.commitdate*o.orderpriority), SUM(l.commitdate*o.clerk), SUM(l.commitdate*o.shippriority), SUM(l.commitdate*o.comment), SUM(l.commitdate*p.mfgr), SUM(l.commitdate*p.brand), SUM(l.commitdate*p.type), SUM(l.commitdate*p.size), SUM(l.commitdate*p.container), SUM(l.commitdate*p.retailprice), SUM(l.commitdate*p.comment), SUM(l.commitdate*s.name), SUM(l.commitdate*s.address), SUM(l.commitdate*s.nationkey), SUM(l.commitdate*s.phone), SUM(l.commitdate*s.acctbal), SUM(l.commitdate*s.comment), SUM(l.commitdate*ps.availqty), SUM(l.commitdate*ps.supplycost), SUM(l.commitdate*ps.comment), SUM(l.commitdate*n.regionkey), SUM(l.commitdate*n.comment), SUM(l.receiptdate*l.receiptdate), SUM(l.receiptdate*l.shipinstruct), SUM(l.receiptdate*l.shipmode), SUM(l.receiptdate*l.comment), SUM(l.receiptdate*o.custkey), SUM(l.receiptdate*o.orderstatus), SUM(l.receiptdate*o.totalprice), SUM(l.receiptdate*o.orderpriority), SUM(l.receiptdate*o.clerk), SUM(l.receiptdate*o.shippriority), SUM(l.receiptdate*o.comment), SUM(l.receiptdate*p.mfgr), SUM(l.receiptdate*p.brand), SUM(l.receiptdate*p.type), SUM(l.receiptdate*p.size), SUM(l.receiptdate*p.container), SUM(l.receiptdate*p.retailprice), SUM(l.receiptdate*p.comment), SUM(l.receiptdate*s.name), SUM(l.receiptdate*s.address), SUM(l.receiptdate*s.nationkey), SUM(l.receiptdate*s.phone), SUM(l.receiptdate*s.acctbal), SUM(l.receiptdate*s.comment), SUM(l.receiptdate*ps.availqty), SUM(l.receiptdate*ps.supplycost), SUM(l.receiptdate*ps.comment), SUM(l.receiptdate*n.regionkey), SUM(l.receiptdate*n.comment), SUM(l.shipinstruct*l.shipinstruct), SUM(l.shipinstruct*l.shipmode), SUM(l.shipinstruct*l.comment), SUM(l.shipinstruct*o.custkey), SUM(l.shipinstruct*o.orderstatus), SUM(l.shipinstruct*o.totalprice), SUM(l.shipinstruct*o.orderpriority), SUM(l.shipinstruct*o.clerk), SUM(l.shipinstruct*o.shippriority), SUM(l.shipinstruct*o.comment), SUM(l.shipinstruct*p.mfgr), SUM(l.shipinstruct*p.brand), SUM(l.shipinstruct*p.type), SUM(l.shipinstruct*p.size), SUM(l.shipinstruct*p.container), SUM(l.shipinstruct*p.retailprice), SUM(l.shipinstruct*p.comment), SUM(l.shipinstruct*s.name), SUM(l.shipinstruct*s.address), SUM(l.shipinstruct*s.nationkey), SUM(l.shipinstruct*s.phone), SUM(l.shipinstruct*s.acctbal), SUM(l.shipinstruct*s.comment), SUM(l.shipinstruct*ps.availqty), SUM(l.shipinstruct*ps.supplycost), SUM(l.shipinstruct*ps.comment), SUM(l.shipinstruct*n.regionkey), SUM(l.shipinstruct*n.comment), SUM(l.shipmode*l.shipmode), SUM(l.shipmode*l.comment), SUM(l.shipmode*o.custkey), SUM(l.shipmode*o.orderstatus), SUM(l.shipmode*o.totalprice), SUM(l.shipmode*o.orderpriority), SUM(l.shipmode*o.clerk), SUM(l.shipmode*o.shippriority), SUM(l.shipmode*o.comment), SUM(l.shipmode*p.mfgr), SUM(l.shipmode*p.brand), SUM(l.shipmode*p.type), SUM(l.shipmode*p.size), SUM(l.shipmode*p.container), SUM(l.shipmode*p.retailprice), SUM(l.shipmode*p.comment), SUM(l.shipmode*s.name), SUM(l.shipmode*s.address), SUM(l.shipmode*s.nationkey), SUM(l.shipmode*s.phone), SUM(l.shipmode*s.acctbal), SUM(l.shipmode*s.comment), SUM(l.shipmode*ps.availqty), SUM(l.shipmode*ps.supplycost), SUM(l.shipmode*ps.comment), SUM(l.shipmode*n.regionkey), SUM(l.shipmode*n.comment), SUM(l.comment*l.comment), SUM(l.comment*o.custkey), SUM(l.comment*o.orderstatus), SUM(l.comment*o.totalprice), SUM(l.comment*o.orderpriority), SUM(l.comment*o.clerk), SUM(l.comment*o.shippriority), SUM(l.comment*o.comment), SUM(l.comment*p.mfgr), SUM(l.comment*p.brand), SUM(l.comment*p.type), SUM(l.comment*p.size), SUM(l.comment*p.container), SUM(l.comment*p.retailprice), SUM(l.comment*p.comment), SUM(l.comment*s.name), SUM(l.comment*s.address), SUM(l.comment*s.nationkey), SUM(l.comment*s.phone), SUM(l.comment*s.acctbal), SUM(l.comment*s.comment), SUM(l.comment*ps.availqty), SUM(l.comment*ps.supplycost), SUM(l.comment*ps.comment), SUM(l.comment*n.regionkey), SUM(l.comment*n.comment), SUM(o.custkey*o.custkey), SUM(o.custkey*o.orderstatus), SUM(o.custkey*o.totalprice), SUM(o.custkey*o.orderpriority), SUM(o.custkey*o.clerk), SUM(o.custkey*o.shippriority), SUM(o.custkey*o.comment), SUM(o.custkey*p.mfgr), SUM(o.custkey*p.brand), SUM(o.custkey*p.type), SUM(o.custkey*p.size), SUM(o.custkey*p.container), SUM(o.custkey*p.retailprice), SUM(o.custkey*p.comment), SUM(o.custkey*s.name), SUM(o.custkey*s.address), SUM(o.custkey*s.nationkey), SUM(o.custkey*s.phone), SUM(o.custkey*s.acctbal), SUM(o.custkey*s.comment), SUM(o.custkey*ps.availqty), SUM(o.custkey*ps.supplycost), SUM(o.custkey*ps.comment), SUM(o.custkey*n.regionkey), SUM(o.custkey*n.comment), SUM(o.orderstatus*o.orderstatus), SUM(o.orderstatus*o.totalprice), SUM(o.orderstatus*o.orderpriority), SUM(o.orderstatus*o.clerk), SUM(o.orderstatus*o.shippriority), SUM(o.orderstatus*o.comment), SUM(o.orderstatus*p.mfgr), SUM(o.orderstatus*p.brand), SUM(o.orderstatus*p.type), SUM(o.orderstatus*p.size), SUM(o.orderstatus*p.container), SUM(o.orderstatus*p.retailprice), SUM(o.orderstatus*p.comment), SUM(o.orderstatus*s.name), SUM(o.orderstatus*s.address), SUM(o.orderstatus*s.nationkey), SUM(o.orderstatus*s.phone), SUM(o.orderstatus*s.acctbal), SUM(o.orderstatus*s.comment), SUM(o.orderstatus*ps.availqty), SUM(o.orderstatus*ps.supplycost), SUM(o.orderstatus*ps.comment), SUM(o.orderstatus*n.regionkey), SUM(o.orderstatus*n.comment), SUM(o.totalprice*o.totalprice), SUM(o.totalprice*o.orderpriority), SUM(o.totalprice*o.clerk), SUM(o.totalprice*o.shippriority), SUM(o.totalprice*o.comment), SUM(o.totalprice*p.mfgr), SUM(o.totalprice*p.brand), SUM(o.totalprice*p.type), SUM(o.totalprice*p.size), SUM(o.totalprice*p.container), SUM(o.totalprice*p.retailprice), SUM(o.totalprice*p.comment), SUM(o.totalprice*s.name), SUM(o.totalprice*s.address), SUM(o.totalprice*s.nationkey), SUM(o.totalprice*s.phone), SUM(o.totalprice*s.acctbal), SUM(o.totalprice*s.comment), SUM(o.totalprice*ps.availqty), SUM(o.totalprice*ps.supplycost), SUM(o.totalprice*ps.comment), SUM(o.totalprice*n.regionkey), SUM(o.totalprice*n.comment), SUM(o.orderpriority*o.orderpriority), SUM(o.orderpriority*o.clerk), SUM(o.orderpriority*o.shippriority), SUM(o.orderpriority*o.comment), SUM(o.orderpriority*p.mfgr), SUM(o.orderpriority*p.brand), SUM(o.orderpriority*p.type), SUM(o.orderpriority*p.size), SUM(o.orderpriority*p.container), SUM(o.orderpriority*p.retailprice), SUM(o.orderpriority*p.comment), SUM(o.orderpriority*s.name), SUM(o.orderpriority*s.address), SUM(o.orderpriority*s.nationkey), SUM(o.orderpriority*s.phone), SUM(o.orderpriority*s.acctbal), SUM(o.orderpriority*s.comment), SUM(o.orderpriority*ps.availqty), SUM(o.orderpriority*ps.supplycost), SUM(o.orderpriority*ps.comment), SUM(o.orderpriority*n.regionkey), SUM(o.orderpriority*n.comment), SUM(o.clerk*o.clerk), SUM(o.clerk*o.shippriority), SUM(o.clerk*o.comment), SUM(o.clerk*p.mfgr), SUM(o.clerk*p.brand), SUM(o.clerk*p.type), SUM(o.clerk*p.size), SUM(o.clerk*p.container), SUM(o.clerk*p.retailprice), SUM(o.clerk*p.comment), SUM(o.clerk*s.name), SUM(o.clerk*s.address), SUM(o.clerk*s.nationkey), SUM(o.clerk*s.phone), SUM(o.clerk*s.acctbal), SUM(o.clerk*s.comment), SUM(o.clerk*ps.availqty), SUM(o.clerk*ps.supplycost), SUM(o.clerk*ps.comment), SUM(o.clerk*n.regionkey), SUM(o.clerk*n.comment), SUM(o.shippriority*o.shippriority), SUM(o.shippriority*o.comment), SUM(o.shippriority*p.mfgr), SUM(o.shippriority*p.brand), SUM(o.shippriority*p.type), SUM(o.shippriority*p.size), SUM(o.shippriority*p.container), SUM(o.shippriority*p.retailprice), SUM(o.shippriority*p.comment), SUM(o.shippriority*s.name), SUM(o.shippriority*s.address), SUM(o.shippriority*s.nationkey), SUM(o.shippriority*s.phone), SUM(o.shippriority*s.acctbal), SUM(o.shippriority*s.comment), SUM(o.shippriority*ps.availqty), SUM(o.shippriority*ps.supplycost), SUM(o.shippriority*ps.comment), SUM(o.shippriority*n.regionkey), SUM(o.shippriority*n.comment), SUM(o.comment*o.comment), SUM(o.comment*p.mfgr), SUM(o.comment*p.brand), SUM(o.comment*p.type), SUM(o.comment*p.size), SUM(o.comment*p.container), SUM(o.comment*p.retailprice), SUM(o.comment*p.comment), SUM(o.comment*s.name), SUM(o.comment*s.address), SUM(o.comment*s.nationkey), SUM(o.comment*s.phone), SUM(o.comment*s.acctbal), SUM(o.comment*s.comment), SUM(o.comment*ps.availqty), SUM(o.comment*ps.supplycost), SUM(o.comment*ps.comment), SUM(o.comment*n.regionkey), SUM(o.comment*n.comment), SUM(p.mfgr*p.mfgr), SUM(p.mfgr*p.brand), SUM(p.mfgr*p.type), SUM(p.mfgr*p.size), SUM(p.mfgr*p.container), SUM(p.mfgr*p.retailprice), SUM(p.mfgr*p.comment), SUM(p.mfgr*s.name), SUM(p.mfgr*s.address), SUM(p.mfgr*s.nationkey), SUM(p.mfgr*s.phone), SUM(p.mfgr*s.acctbal), SUM(p.mfgr*s.comment), SUM(p.mfgr*ps.availqty), SUM(p.mfgr*ps.supplycost), SUM(p.mfgr*ps.comment), SUM(p.mfgr*n.regionkey), SUM(p.mfgr*n.comment), SUM(p.brand*p.brand), SUM(p.brand*p.type), SUM(p.brand*p.size), SUM(p.brand*p.container), SUM(p.brand*p.retailprice), SUM(p.brand*p.comment), SUM(p.brand*s.name), SUM(p.brand*s.address), SUM(p.brand*s.nationkey), SUM(p.brand*s.phone), SUM(p.brand*s.acctbal), SUM(p.brand*s.comment), SUM(p.brand*ps.availqty), SUM(p.brand*ps.supplycost), SUM(p.brand*ps.comment), SUM(p.brand*n.regionkey), SUM(p.brand*n.comment), SUM(p.type*p.type), SUM(p.type*p.size), SUM(p.type*p.container), SUM(p.type*p.retailprice), SUM(p.type*p.comment), SUM(p.type*s.name), SUM(p.type*s.address), SUM(p.type*s.nationkey), SUM(p.type*s.phone), SUM(p.type*s.acctbal), SUM(p.type*s.comment), SUM(p.type*ps.availqty), SUM(p.type*ps.supplycost), SUM(p.type*ps.comment), SUM(p.type*n.regionkey), SUM(p.type*n.comment), SUM(p.size*p.size), SUM(p.size*p.container), SUM(p.size*p.retailprice), SUM(p.size*p.comment), SUM(p.size*s.name), SUM(p.size*s.address), SUM(p.size*s.nationkey), SUM(p.size*s.phone), SUM(p.size*s.acctbal), SUM(p.size*s.comment), SUM(p.size*ps.availqty), SUM(p.size*ps.supplycost), SUM(p.size*ps.comment), SUM(p.size*n.regionkey), SUM(p.size*n.comment), SUM(p.container*p.container), SUM(p.container*p.retailprice), SUM(p.container*p.comment), SUM(p.container*s.name), SUM(p.container*s.address), SUM(p.container*s.nationkey), SUM(p.container*s.phone), SUM(p.container*s.acctbal), SUM(p.container*s.comment), SUM(p.container*ps.availqty), SUM(p.container*ps.supplycost), SUM(p.container*ps.comment), SUM(p.container*n.regionkey), SUM(p.container*n.comment), SUM(p.retailprice*p.retailprice), SUM(p.retailprice*p.comment), SUM(p.retailprice*s.name), SUM(p.retailprice*s.address), SUM(p.retailprice*s.nationkey), SUM(p.retailprice*s.phone), SUM(p.retailprice*s.acctbal), SUM(p.retailprice*s.comment), SUM(p.retailprice*ps.availqty), SUM(p.retailprice*ps.supplycost), SUM(p.retailprice*ps.comment), SUM(p.retailprice*n.regionkey), SUM(p.retailprice*n.comment), SUM(p.comment*p.comment), SUM(p.comment*s.name), SUM(p.comment*s.address), SUM(p.comment*s.nationkey), SUM(p.comment*s.phone), SUM(p.comment*s.acctbal), SUM(p.comment*s.comment), SUM(p.comment*ps.availqty), SUM(p.comment*ps.supplycost), SUM(p.comment*ps.comment), SUM(p.comment*n.regionkey), SUM(p.comment*n.comment), SUM(s.name*s.name), SUM(s.name*s.address), SUM(s.name*s.nationkey), SUM(s.name*s.phone), SUM(s.name*s.acctbal), SUM(s.name*s.comment), SUM(s.name*ps.availqty), SUM(s.name*ps.supplycost), SUM(s.name*ps.comment), SUM(s.name*n.regionkey), SUM(s.name*n.comment), SUM(s.address*s.address), SUM(s.address*s.nationkey), SUM(s.address*s.phone), SUM(s.address*s.acctbal), SUM(s.address*s.comment), SUM(s.address*ps.availqty), SUM(s.address*ps.supplycost), SUM(s.address*ps.comment), SUM(s.address*n.regionkey), SUM(s.address*n.comment), SUM(s.nationkey*s.nationkey), SUM(s.nationkey*s.phone), SUM(s.nationkey*s.acctbal), SUM(s.nationkey*s.comment), SUM(s.nationkey*ps.availqty), SUM(s.nationkey*ps.supplycost), SUM(s.nationkey*ps.comment), SUM(s.nationkey*n.regionkey), SUM(s.nationkey*n.comment), SUM(s.phone*s.phone), SUM(s.phone*s.acctbal), SUM(s.phone*s.comment), SUM(s.phone*ps.availqty), SUM(s.phone*ps.supplycost), SUM(s.phone*ps.comment), SUM(s.phone*n.regionkey), SUM(s.phone*n.comment), SUM(s.acctbal*s.acctbal), SUM(s.acctbal*s.comment), SUM(s.acctbal*ps.availqty), SUM(s.acctbal*ps.supplycost), SUM(s.acctbal*ps.comment), SUM(s.acctbal*n.regionkey), SUM(s.acctbal*n.comment), SUM(s.comment*s.comment), SUM(s.comment*ps.availqty), SUM(s.comment*ps.supplycost), SUM(s.comment*ps.comment), SUM(s.comment*n.regionkey), SUM(s.comment*n.comment), SUM(ps.availqty*ps.availqty), SUM(ps.availqty*ps.supplycost), SUM(ps.availqty*ps.comment), SUM(ps.availqty*n.regionkey), SUM(ps.availqty*n.comment), SUM(ps.supplycost*ps.supplycost), SUM(ps.supplycost*ps.comment), SUM(ps.supplycost*n.regionkey), SUM(ps.supplycost*n.comment), SUM(ps.comment*ps.comment), SUM(ps.comment*n.regionkey), SUM(ps.comment*n.comment), SUM(n.regionkey*n.regionkey), SUM(n.regionkey*n.comment), SUM(n.comment*n.comment)
  FROM  part p, supplier s, lineitem l, partsupp ps, orders o, nation n
 WHERE  s.suppkey = l.suppkey
   AND  ps.suppkey = l.suppkey 
   AND  ps.partkey = l.partkey
   AND  p.partkey = l.partkey
   AND  o.orderkey = l.orderkey 
   AND  s.nationkey = n.nationkey 
   AND  (p.name LIKE '%green%')
GROUP BY nation, o_year;
